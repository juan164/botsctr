{
  "Name": "CountTramas",
  "CreationDate": "2021-3-28",
  "Commands": [
    {
      "Command": "executeScript_Sandbox",
      "Target": "return 0;",
      "Value": "retry_download"
    },
    {
      "Command": "label",
      "Target": "REBOOT_VALIDATION_DOWNLOAD",
      "Value": ""
    },
    {
      "Command": "run",
      "Target": "../Shared/GoReport",
      "Value": ""
    },
    {
      "Command": "click",
      "Target": "name=ProcessLogListTable_length",
      "Value": "",
      "Targets": [
        "name=ProcessLogListTable_length",
        "xpath=//*[@id=\"ProcessLogListTable_length\"]/label/select",
        "xpath=//select[@name='ProcessLogListTable_length']",
        "xpath=//label/select",
        "css=#ProcessLogListTable_length > label > select"
      ]
    },
    {
      "Command": "select",
      "Target": "name=ProcessLogListTable_length",
      "Value": "label=25"
    },
    {
      "Command": "click",
      "Target": "name=ProcessLogListTable_length",
      "Value": "",
      "Targets": [
        "name=ProcessLogListTable_length",
        "xpath=//*[@id=\"ProcessLogListTable_length\"]/label/select",
        "xpath=//select[@name='ProcessLogListTable_length']",
        "xpath=//label/select",
        "css=#ProcessLogListTable_length > label > select"
      ]
    },
    {
      "Command": "store",
      "Target": "true",
      "Value": "!errorignore"
    },
    {
      "Command": "csvRead",
      "Target": "csv_ids.csv",
      "Value": ""
    },
    {
      "Command": "if_v2",
      "Target": "${!statusok} == false",
      "Value": ""
    },
    {
      "Command": "run",
      "Target": "../Exception/HandlerNumberTramas",
      "Value": ""
    },
    {
      "Command": "end",
      "Target": "",
      "Value": ""
    },
    {
      "Command": "store",
      "Target": "false",
      "Value": "!errorignore"
    },
    {
      "Command": "store",
      "Target": "${!csvReadMaxRow}",
      "Value": "!csvReadLineNumber"
    },
    {
      "Command": "csvRead",
      "Target": "csv_ids.csv",
      "Value": ""
    },
    {
      "Command": "store",
      "Target": "true",
      "Value": "!errorignore"
    },
    {
      "Command": "echo",
      "Target": "${!COL1}",
      "Value": ""
    },
    {
      "Command": "echo",
      "Target": "${!COL2}",
      "Value": ""
    },
    {
      "Command": "echo",
      "Target": "${!COL3}",
      "Value": ""
    },
    {
      "Command": "echo",
      "Target": "${!COL4}",
      "Value": ""
    },
    {
      "Command": "if_v2",
      "Target": "${!statusok} == false",
      "Value": ""
    },
    {
      "Command": "run",
      "Target": "../Exception/HandlerNumberTramas",
      "Value": ""
    },
    {
      "Command": "end",
      "Target": "",
      "Value": ""
    },
    {
      "Command": "store",
      "Target": "false",
      "Value": "!errorignore"
    },
    {
      "Command": "run",
      "Target": "../Shared/SetToday",
      "Value": ""
    },
    {
      "Command": "executeScript_Sandbox",
      "Target": "return false;",
      "Value": "is_not_today"
    },
    {
      "Command": "executeScript_Sandbox",
      "Target": "return 0;",
      "Value": "download_count"
    },
    {
      "Command": "executeScript_Sandbox",
      "Target": "return 0;",
      "Value": "download_ok_count"
    },
    {
      "Command": "executeScript_Sandbox",
      "Target": "return 0;",
      "Value": "idx_row_trama"
    },
    {
      "Command": "while_v2",
      "Target": "${download_count} < 4",
      "Value": ""
    },
    {
      "Command": "executeScript_Sandbox",
      "Target": "return ${idx_row_trama} + 1;",
      "Value": "idx_row_trama"
    },
    {
      "Command": "storeText",
      "Target": "xpath=//*[@id=\"ProcessLogListTable\"]/tbody/tr[${idx_row_trama}]/td[2]",
      "Value": "row_trama_id"
    },
    {
      "Command": "executeScript_Sandbox",
      "Target": "var ids = [${!COL1}, ${!COL2}, ${!COL3}, ${!COL4}];\nreturn ids.indexOf(${row_trama_id}) > -1;\n\n",
      "Value": "row_is_downloadable"
    },
    {
      "Command": "if_v2",
      "Target": "${row_is_downloadable} == true",
      "Value": ""
    },
    {
      "Command": "executeScript_Sandbox",
      "Target": "return ${download_count} + 1;",
      "Value": "download_count"
    },
    {
      "Command": "storeText",
      "Target": "xpath=//*[@id=\"ProcessLogListTable\"]/tbody/tr[${idx_row_trama}]/td[7]",
      "Value": "row_trama_state"
    },
    {
      "Command": "storeText",
      "Target": "xpath=//*[@id=\"ProcessLogListTable\"]/tbody/tr[${idx_row_trama}]/td[6]",
      "Value": "row_trama_user"
    },
    {
      "Command": "storeText",
      "Target": "xpath=//*[@id=\"ProcessLogListTable\"]/tbody/tr[${idx_row_trama}]/td[3]",
      "Value": "row_trama_date"
    },
    {
      "Command": "executeScript_Sandbox",
      "Target": "var today = ${today};\nvar row_date = ${row_trama_date};\nif (row_date.length == 0) return false;\nreturn row_date.indexOf(today) < 0;",
      "Value": "is_not_today"
    },
    {
      "Command": "if_v2",
      "Target": "${row_trama_user} == 'CARLOS SHOGO CONTRERAS' && ${is_not_today} == false",
      "Value": ""
    },
    {
      "Command": "if_v2",
      "Target": "${row_trama_state} == 'Completado' ",
      "Value": ""
    },
    {
      "Command": "executeScript_Sandbox",
      "Target": "return ${download_ok_count} + 1;",
      "Value": "download_ok_count"
    },
    {
      "Command": "end",
      "Target": "",
      "Value": ""
    },
    {
      "Command": "else",
      "Target": "",
      "Value": ""
    },
    {
      "Command": "run",
      "Target": "../Exception/HandlerNumberTramas",
      "Value": ""
    },
    {
      "Command": "end",
      "Target": "",
      "Value": ""
    },
    {
      "Command": "end",
      "Target": "",
      "Value": ""
    },
    {
      "Command": "end",
      "Target": "",
      "Value": ""
    },
    {
      "Command": "if_v2",
      "Target": "${download_ok_count} < 4 ",
      "Value": ""
    },
    {
      "Command": "executeScript_Sandbox",
      "Target": "return ${retry_download} + 1;",
      "Value": "retry_download"
    },
    {
      "Command": "if_v2",
      "Target": "${retry_download} <= 1",
      "Value": ""
    },
    {
      "Command": "run",
      "Target": "../Shared/LogOut",
      "Value": ""
    },
    {
      "Command": "pause",
      "Target": "1800000",
      "Value": ""
    },
    {
      "Command": "run",
      "Target": "../Shared/LogIn",
      "Value": ""
    },
    {
      "Command": "gotoLabel",
      "Target": "REBOOT_VALIDATION_DOWNLOAD",
      "Value": ""
    },
    {
      "Command": "else",
      "Target": "",
      "Value": ""
    },
    {
      "Command": "run",
      "Target": "../Exception/HandlerNumberTramas",
      "Value": ""
    },
    {
      "Command": "end",
      "Target": "",
      "Value": ""
    },
    {
      "Command": "end",
      "Target": "",
      "Value": ""
    }
  ]
}