{
  "Name": "SelectLastDate",
  "CreationDate": "2021-3-28",
  "Commands": [
    {
      "Command": "executeScript_Sandbox",
      "Target": "var today = new Date();var dd = today.getDate() < 10 ? '0'+ today.getDate() : today.getDate(); return dd;",
      "Value": "current_day"
    },
    {
      "Command": "executeScript_Sandbox",
      "Target": "return 0;",
      "Value": "idx_week"
    },
    {
      "Command": "while_v2",
      "Target": "${idx_week} < 6",
      "Value": ""
    },
    {
      "Command": "executeScript_Sandbox",
      "Target": "return ${idx_week} + 1;",
      "Value": "idx_week"
    },
    {
      "Command": "executeScript_Sandbox",
      "Target": "return 0;",
      "Value": "idx_day"
    },
    {
      "Command": "while_v2",
      "Target": "${idx_day} < 7",
      "Value": ""
    },
    {
      "Command": "executeScript_Sandbox",
      "Target": "return ${idx_day} + 1;",
      "Value": "idx_day"
    },
    {
      "Command": "storeText",
      "Target": "xpath=/html/body/div[9]/div/div/table/tbody/tr[${idx_week}]/td[${idx_day}]",
      "Value": "picker_day"
    },
    {
      "Command": "storeAttribute",
      "Target": "xpath=/html/body/div[9]/div/div/table/tbody/tr[${idx_week}]/td[${idx_day}]@class",
      "Value": "picker_css"
    },
    {
      "Command": "executeScript_Sandbox",
      "Target": "var today = ${current_day};\nvar css = ${picker_css};\nvar day = ${picker_day};\nvar unavailable = (css.indexOf('available off') > -1 || css.indexOf('off disabled') > -1);\nreturn Number(today) == Number(day) && !unavailable;",
      "Value": "picker_is_today"
    },
    {
      "Command": "if_v2",
      "Target": "${picker_is_today} == true",
      "Value": ""
    },
    {
      "Command": "executeScript_Sandbox",
      "Target": "var iterador_dia = ${idx_day};\nreturn Number(iterador_dia) == 1 ? 7 : Number(iterador_dia) - 1;",
      "Value": "picker_select_day"
    },
    {
      "Command": "executeScript_Sandbox",
      "Target": "var iterador_semana = ${idx_week};\nvar iterador_dia = ${idx_day};\nreturn Number(iterador_dia) == 1 ? Number(iterador_semana) - 1 : Number(iterador_semana);",
      "Value": "picker_select_week"
    },
    {
      "Command": "executeScript_Sandbox",
      "Target": "return 9999;",
      "Value": "idx_day"
    },
    {
      "Command": "executeScript_Sandbox",
      "Target": "return 9999;",
      "Value": "idx_week"
    },
    {
      "Command": "end",
      "Target": "",
      "Value": ""
    },
    {
      "Command": "end",
      "Target": "",
      "Value": ""
    },
    {
      "Command": "end",
      "Target": "",
      "Value": ""
    },
    {
      "Command": "mouseOver",
      "Target": "xpath=/html/body/div[9]/div/div/table/tbody/tr[${picker_select_week}]/td[${picker_select_day}]",
      "Value": "",
      "Targets": [
        "xpath=/html/body/div[9]/div/div/table/tbody/tr[5]/td[4]",
        "xpath=//div[9]/div/div/table/tbody/tr[5]/td[4]",
        "css=body > div:nth-child(109) > div.calendar.right > div > table > tbody > tr:nth-child(5) > td.available.active.end-date"
      ]
    },
    {
      "Command": "click",
      "Target": "xpath=/html/body/div[9]/div/div/table/tbody/tr[${picker_select_week}]/td[${picker_select_day}]",
      "Value": "",
      "Targets": [
        "xpath=/html/body/div[9]/div/div/table/tbody/tr[5]/td[4]",
        "xpath=//div[9]/div/div/table/tbody/tr[5]/td[4]",
        "css=body > div:nth-child(109) > div.calendar.right > div > table > tbody > tr:nth-child(5) > td.available.active.end-date"
      ]
    }
  ]
}