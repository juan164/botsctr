{
  "Name": "SelectLastDate",
  "CreationDate": "2021-3-25",
  "Commands": [
    {
      "Command": "executeScript_Sandbox",
      "Target": "var today = new Date();var dd = today.getDate() < 10 ? '0'+ today.getDate() : today.getDate(); return dd;",
      "Value": "var_dia_actual"
    },
    {
      "Command": "store",
      "Target": "0",
      "Value": "var_iterador_semana"
    },
    {
      "Command": "while_v2",
      "Target": "${var_iterador_semana} < 6",
      "Value": ""
    },
    {
      "Command": "executeScript_Sandbox",
      "Target": "return Number(${var_iterador_semana}) + 1;",
      "Value": "var_iterador_semana"
    },
    {
      "Command": "store",
      "Target": "0",
      "Value": "var_iterador_dia"
    },
    {
      "Command": "while_v2",
      "Target": "${var_iterador_dia} < 7",
      "Value": ""
    },
    {
      "Command": "executeScript_Sandbox",
      "Target": "return Number(${var_iterador_dia}) + 1;",
      "Value": "var_iterador_dia"
    },
    {
      "Command": "storeText",
      "Target": "xpath=/html/body/div[9]/div/div/table/tbody/tr[${var_iterador_semana}]/td[${var_iterador_dia}]",
      "Value": "var_dia"
    },
    {
      "Command": "storeAttribute",
      "Target": "xpath=/html/body/div[9]/div/div/table/tbody/tr[${var_iterador_semana}]/td[${var_iterador_dia}]@class",
      "Value": "var_css_dia"
    },
    {
      "Command": "comment",
      "Target": "echo // Dia: ${var_dia} - Atributo: ${var_css_dia}",
      "Value": "navy"
    },
    {
      "Command": "executeScript_Sandbox",
      "Target": "var today = ${var_dia_actual};\nvar css = ${var_css_dia};\nvar day = ${var_dia};\nvar unavailable = (css.indexOf('available off') > -1 || css.indexOf('off disabled') > -1);\nreturn Number(today) == Number(day) && !unavailable;",
      "Value": "var_dia_correcto"
    },
    {
      "Command": "comment",
      "Target": "echo // Es correcto: ${var_dia_correcto}",
      "Value": "navy"
    },
    {
      "Command": "if_v2",
      "Target": "${var_dia_correcto} == true",
      "Value": ""
    },
    {
      "Command": "executeScript_Sandbox",
      "Target": "var iterador_dia = ${var_iterador_dia};\nreturn Number(iterador_dia) == 1 ? 7 : Number(iterador_dia) - 1;",
      "Value": "var_idx_hasta_dia"
    },
    {
      "Command": "executeScript_Sandbox",
      "Target": "var iterador_semana = ${var_iterador_semana};\nvar iterador_dia = ${var_iterador_dia};\nreturn Number(iterador_dia) == 1 ? Number(iterador_semana) - 1 : Number(iterador_semana);",
      "Value": "var_idx_hasta_semana"
    },
    {
      "Command": "store",
      "Target": "9999",
      "Value": "var_iterador_dia"
    },
    {
      "Command": "store",
      "Target": "9999",
      "Value": "var_iterador_semana"
    },
    {
      "Command": "end",
      "Target": "",
      "Value": ""
    },
    {
      "Command": "end",
      "Target": "",
      "Value": ""
    },
    {
      "Command": "end",
      "Target": "",
      "Value": ""
    },
    {
      "Command": "mouseOver",
      "Target": "xpath=/html/body/div[9]/div/div/table/tbody/tr[${var_idx_hasta_semana}]/td[${var_idx_hasta_dia}]",
      "Value": "",
      "Targets": [
        "xpath=/html/body/div[9]/div/div/table/tbody/tr[5]/td[4]",
        "xpath=//div[9]/div/div/table/tbody/tr[5]/td[4]",
        "css=body > div:nth-child(109) > div.calendar.right > div > table > tbody > tr:nth-child(5) > td.available.active.end-date"
      ]
    },
    {
      "Command": "click",
      "Target": "xpath=/html/body/div[9]/div/div/table/tbody/tr[${var_idx_hasta_semana}]/td[${var_idx_hasta_dia}]",
      "Value": "",
      "Targets": [
        "xpath=/html/body/div[9]/div/div/table/tbody/tr[5]/td[4]",
        "xpath=//div[9]/div/div/table/tbody/tr[5]/td[4]",
        "css=body > div:nth-child(109) > div.calendar.right > div > table > tbody > tr:nth-child(5) > td.available.active.end-date"
      ]
    }
  ]
}